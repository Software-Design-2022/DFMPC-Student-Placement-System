{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport * as Device from \"expo-device\";\nimport * as Notifications from \"expo-notifications\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport LogBox from \"react-native-web/dist/exports/LogBox\";\nimport \"../global\";\nimport { firebase } from \"../firebase\";\nimport { useNavigation } from \"@react-navigation/core\";\nimport { createTopBar } from \"../HelperFunctions\";\nimport { Modal } from \"react-native-paper\";\nimport { schedulePushNotification, EventNotification } from \"./SendNotification\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar authname = authName;\nvar authlastName = authLastName;\nvar latitude = 20;\nvar longitude = 30;\nvar msg = {\n  title: \"Message\",\n  body: \"Emergency Message Has Been Sent\",\n  data: {\n    data: \"goes here\"\n  }\n};\n\nvar sendToFirestore = function sendToFirestore(text, msg) {\n  firebase.firestore().collection(\"panic_button\").add({\n    Location: [-latitude, longitude],\n    query: text,\n    student_Number: \"123456\",\n    user_FirstName: authname,\n    user_LastName: authlastName\n  }).then(function () {\n    Alert.alert(\"Emergency Message Saved\");\n    schedulePushNotification(msg, \"Emergency Page\");\n  });\n};\n\nexport default function EmergencyPage() {\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      text = _useState2[0],\n      setText = _useState2[1];\n\n  var navigation = useNavigation();\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      expoPushToken = _useState4[0],\n      setExpoPushToken = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      notification = _useState6[0],\n      setNotification = _useState6[1];\n\n  var notificationListener = useRef();\n  var responseListener = useRef();\n  var modalVisible = false;\n  LogBox.ignoreLogs([\"Setting a timer\"]);\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(View, {\n      style: {\n        position: \"absolute\"\n      },\n      children: _jsx(Image, {\n        resizeMode: \"contain\",\n        source: require(\"./images/background.png\"),\n        blurRadius: 0\n      })\n    }), _jsxs(View, {\n      style: {\n        flex: 1\n      },\n      children: [createTopBar(10, navigation), _jsx(View, {\n        style: {\n          padding: 10,\n          marginBottom: 20,\n          top: 60\n        },\n        children: _jsx(TextInput, {\n          style: styles.message,\n          placeholder: \"Type emergency message here!\",\n          onChangeText: function onChangeText(newText) {\n            return setText(newText);\n          },\n          defaultValue: text\n        })\n      }), _jsx(View, {\n        style: {\n          margin: 20,\n          top: 60\n        },\n        children: _jsx(Button, {\n          title: \"Send Emergency message\",\n          color: \"#415A77\",\n          onPress: function onPress() {\n            return sendToFirestore(text, msg);\n          }\n        })\n      })]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    top: 0,\n    flex: 1,\n    justifyContent: \"center\",\n    backgroundColor: \"rgba(192,192,192,0.3)\"\n  },\n  message: {\n    marginTop: 50,\n    marginBottom: 20,\n    marginRight: 5,\n    marginLeft: 5,\n    height: 200,\n    textAlign: \"center\",\n    borderRadius: 5,\n    backgroundColor: \"white\"\n  },\n  Button1: {\n    backgroundColor: \"rgba(221, 240, 255,0.2)\"\n  },\n  title: {\n    textAlign: \"center\",\n    marginVertical: 8\n  },\n  fixToText: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  },\n  map: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0\n  },\n  MapStyle: {\n    flex: 1,\n    margin: 20,\n    marginBottom: 90,\n    justifyContent: \"center\"\n  }\n});","map":{"version":3,"names":["Device","Notifications","React","useState","useEffect","useRef","firebase","useNavigation","createTopBar","Modal","schedulePushNotification","EventNotification","authname","authName","authlastName","authLastName","latitude","longitude","msg","title","body","data","sendToFirestore","text","firestore","collection","add","Location","query","student_Number","user_FirstName","user_LastName","then","Alert","alert","EmergencyPage","setText","navigation","expoPushToken","setExpoPushToken","notification","setNotification","notificationListener","responseListener","modalVisible","LogBox","ignoreLogs","styles","container","position","require","flex","padding","marginBottom","top","message","newText","margin","StyleSheet","create","justifyContent","backgroundColor","marginTop","marginRight","marginLeft","height","textAlign","borderRadius","Button1","marginVertical","fixToText","flexDirection","map","left","bottom","right","MapStyle"],"sources":["/home/cipher73/Coding Projects/Sprint3-final/DFMPC-Student-Placement-System/Screens/EmergencyPage.js"],"sourcesContent":["import * as Device from \"expo-device\";\nimport * as Notifications from \"expo-notifications\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport {\n  Text,\n  View,\n  Button,\n  SafeAreaView,\n  StyleSheet,\n  Image,\n  TextInput,\n  Alert,\n  LogBox,\n} from \"react-native\";\nimport \"../global\";\nimport { firebase } from \"../firebase\";\nimport { useNavigation } from \"@react-navigation/core\";\nimport { createTopBar } from \"../HelperFunctions\";\nimport { Modal } from \"react-native-paper\";\nimport {schedulePushNotification,EventNotification} from \"./SendNotification\"\n\nconst authname = authName;\nconst authlastName = authLastName;\nconst latitude = 20;\nconst longitude = 30;\n\nconst msg = {\n  title: \"Message\",\n  body: \"Emergency Message Has Been Sent\",\n  data: { data: \"goes here\" },\n};\nconst sendToFirestore = (text, msg) => {\n  firebase\n    .firestore()\n    .collection(\"panic_button\")\n    .add({\n      Location: [-latitude, longitude],\n      query: text,\n      student_Number: \"123456\",\n      user_FirstName: authname,\n      user_LastName: authlastName,\n    })\n    .then(() => {\n      Alert.alert(\"Emergency Message Saved\");\n      schedulePushNotification(msg,\"Emergency Page\");\n      \n\n    });\n};\n\n\nexport default function EmergencyPage() {\n  const [text, setText] = useState(\"\");\n  const navigation = useNavigation();\n  const [expoPushToken, setExpoPushToken] = useState(\"\");\n  const [notification, setNotification] = useState(false);\n  const notificationListener = useRef();\n  const responseListener = useRef();\n  const modalVisible = false;\n /*  useEffect(() => {\n    let cancel = false;\n    registerForPushNotificationsAsync().then((token) => {\n      if (cancel) return;\n      setExpoPushToken(token);\n    });\n\n    notificationListener.current =\n      Notifications.addNotificationReceivedListener((notification) => {\n        setNotification(notification);\n      });\n\n    responseListener.current =\n      Notifications.addNotificationResponseReceivedListener((response) => {\n        console.log(response);\n      });\n\n    return () => {\n      Notifications.removeNotificationSubscription(\n        notificationListener.current\n      );\n      Notifications.removeNotificationSubscription(responseListener.current);\n      cancel = true;\n    };\n  }, []); */\n  LogBox.ignoreLogs([\"Setting a timer\"]);\n\n  return (\n    <View style={styles.container}>\n      \n      <View style={{ position: \"absolute\" }}>\n        <Image\n          resizeMode=\"contain\"\n          source={require(\"./images/background.png\")}\n          blurRadius={0}\n        />\n      </View>\n      <View style={{ flex: 1 }}>\n        {createTopBar(10, navigation)}\n\n        <View style={{ padding: 10, marginBottom: 20, top: 60 }}>\n          <TextInput\n            // user can type their emergency message\n            style={styles.message}\n            placeholder=\"Type emergency message here!\"\n            onChangeText={(newText) => setText(newText)}\n            defaultValue={text}\n          />\n        </View>\n\n        <View style={{ margin: 20, top: 60 }}>\n          <Button\n            title=\"Send Emergency message\"\n            color=\"#415A77\"\n            // when clicked data is send to firestore database\n            onPress={() => sendToFirestore(text, msg)}\n          />\n        </View>\n      </View>\n    </View>\n  );\n}\n/* \nasync function schedulePushNotification(msg) {\n  await Notifications.scheduleNotificationAsync({\n    content: {\n      title: msg.title,\n      body: msg.body,\n      data: msg.data,\n    },\n    trigger: { seconds: 1 },\n  });\n}\n\nasync function registerForPushNotificationsAsync() {\n  let token;\n  if (Device.isDevice) {\n    const { status: existingStatus } =\n      await Notifications.getPermissionsAsync();\n    let finalStatus = existingStatus;\n    if (existingStatus !== \"granted\") {\n      const { status } = await Notifications.requestPermissionsAsync();\n      finalStatus = status;\n    }\n    if (finalStatus !== \"granted\") {\n      alert(\"Failed to get push token for push notification!\");\n      return;\n    }\n    token = (await Notifications.getExpoPushTokenAsync()).data;\n  }\n\n  if (Platform.OS === \"android\") {\n    await Notifications.setNotificationChannelAsync(\"default\", {\n      name: \"default\",\n      importance: Notifications.AndroidImportance.MAX,\n      vibrationPattern: [0, 250, 250, 250],\n      lightColor: \"#FF231F7C\",\n    });\n  }\n\n  return token;\n} */\n\nconst styles = StyleSheet.create({\n  container: {\n    top: 0,\n    flex: 1,\n    justifyContent: \"center\",\n    backgroundColor: \"rgba(192,192,192,0.3)\",\n  },\n  message: {\n    marginTop: 50,\n    marginBottom: 20,\n    marginRight: 5,\n    marginLeft: 5,\n    height: 200,\n    textAlign: \"center\",\n    borderRadius: 5,\n    backgroundColor: \"white\",\n  },\n\n  Button1: {\n    backgroundColor: \"rgba(221, 240, 255,0.2)\",\n  },\n\n  title: {\n    textAlign: \"center\",\n    marginVertical: 8,\n  },\n  fixToText: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  map: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n  },\n  MapStyle: {\n    flex: 1,\n    margin: 20,\n    marginBottom: 90,\n\n    justifyContent: \"center\",\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}