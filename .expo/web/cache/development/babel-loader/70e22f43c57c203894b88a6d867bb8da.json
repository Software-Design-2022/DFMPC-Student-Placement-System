{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { graphConfig } from \"../authConfig\";\nexport function callMsGraph(accessToken) {\n  var headers, bearer, options;\n  return _regeneratorRuntime.async(function callMsGraph$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          headers = new Headers();\n          bearer = \"Bearer \" + accessToken;\n          headers.append(\"Authorization\", bearer);\n          options = {\n            method: \"GET\",\n            headers: headers\n          };\n          return _context.abrupt(\"return\", fetch(graphConfig.graphMeEndpoint, options).then(function (response) {\n            return response.json();\n          }).catch(function (error) {\n            return console.log(error);\n          }));\n\n        case 5:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}","map":{"version":3,"names":["graphConfig","callMsGraph","accessToken","headers","Headers","bearer","append","options","method","fetch","graphMeEndpoint","then","response","json","catch","error","console","log"],"sources":["C:/Users/nokno/OneDrive/Documents/GitHub/DFMPC-Student-Placement-System/Screens/graph.js"],"sourcesContent":["import {graphConfig}  from \"../authConfig\";\r\n\r\n/**\r\n * Attaches a given access token to a Microsoft Graph API call. Returns information about the user\r\n */\r\nexport async function callMsGraph(accessToken) {\r\n    const headers = new Headers();\r\n    const bearer = `Bearer ${accessToken}`;\r\n\r\n    headers.append(\"Authorization\", bearer);\r\n\r\n    const options = {\r\n        method: \"GET\",\r\n        headers: headers\r\n    };\r\n\r\n    return fetch(graphConfig.graphMeEndpoint, options)\r\n        .then(response => response.json())\r\n        .catch(error => console.log(error));\r\n}"],"mappings":";AAAA,SAAQA,WAAR;AAKA,OAAO,SAAeC,WAAf,CAA2BC,WAA3B;EAAA;EAAA;IAAA;MAAA;QAAA;UACGC,OADH,GACa,IAAIC,OAAJ,EADb;UAEGC,MAFH,eAEsBH,WAFtB;UAIHC,OAAO,CAACG,MAAR,CAAe,eAAf,EAAgCD,MAAhC;UAEME,OANH,GAMa;YACZC,MAAM,EAAE,KADI;YAEZL,OAAO,EAAEA;UAFG,CANb;UAAA,iCAWIM,KAAK,CAACT,WAAW,CAACU,eAAb,EAA8BH,OAA9B,CAAL,CACFI,IADE,CACG,UAAAC,QAAQ;YAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ;UAAA,CADX,EAEFC,KAFE,CAEI,UAAAC,KAAK;YAAA,OAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ;UAAA,CAFT,CAXJ;;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA;AAAA"},"metadata":{},"sourceType":"module"}