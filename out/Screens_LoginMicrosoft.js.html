<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Screens/LoginMicrosoft.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Screens/LoginMicrosoft.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from "react";
import MicrosoftLogin from "react-microsoft-login";
import { useNavigation } from "@react-navigation/core";
import { Button } from "react-native-web";
import "./global";
import { firebase } from "../firebase";

/**
 * @function LoginMicrosoft
 * @description This is the login screen for the application. It will allow the user to login using their Microsoft
 *            account. It will then redirect the user to the dashboard screen.
 * @returns {JSX.Element} - The login screen.
 * @constructor
 * @memberof Screens
 * @todo Add a loading screen while the user is being redirected to the dashboard screen.
 * @param {firebaseObject} data
 * @see {@link https://www.npmjs.com/package/react-microsoft-login}
 */
export function setUserVariables(data) {
  // store information about the user who is currently logged in
  authUser = data;
  console.log(data);
  authUserID = data.child("id").val();
  //authStudentNumber= authUser.child("")user_FirstName

  //global user variables to be accessed through app
  authName = authUser.child("user_FirstName").val();
  authLastName = authUser.child("user_LastName").val();
  authUserProfilePic = authUser.child("user_profile_photo/").val();
  authUserRef = firebase.database().ref("/users") + "/" + authUserID + "/";
  console.log("User ID: " + authUserID + " authenticated.");
}

export function retrieveUser() {
  firebase
    .database()
    .ref("/users")
    .on("value", (snapshot) => {
      const key = snapshot.forEach(function (data) {
        const check_email = snapshot.child(data.key + "/microsoft_email").val();

        if (check_email === authEmail) {
          // compare entered email with current email on the snapshot

          setUserVariables(data); // so that we can keep track of who is logged in currenctly
        }
      });
    });
}
/**
 * @module LoginMicrosoft
 * @description This is the login screen for the application. It will allow the user to login using their Microsoft
 *           account. It will then redirect the user to the dashboard screen.
 * @returns {JSX.Element} - The login screen.
 */
export default (props) => {
  const navigation = useNavigation(); //navigation between screens

  /**
   * @function login
   * @param {string} err error message
   * @param {Object} data data object
   */
  const authHandler = (err, data) => {
    //save microsoft user data
    MSuser = data;
    console.log(MSuser.account.userName);
    //set user email to temp outlook email for database
    authEmail = "john_green_test@outlook.com";
    //once successfull navigate to dashboard
    navigation.navigate("Dashboard");
    retrieveUser();
  };
  return (
    //Microsoft button displayed for sign in
    &lt;MicrosoftLogin
      clientId={"2601b63e-4012-441c-a18d-d6d8e4cd6a29"}
      authCallback={authHandler}
    />
  );
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-App%2520-%2520The%2520Main%2520App%2520Component.html">App - The Main App Component</a></li><li><a href="module-CalendarView.html">CalendarView</a></li><li><a href="module-Dashboard.html">Dashboard</a></li><li><a href="module-DayAgenda.html">DayAgenda</a></li><li><a href="module-EmergencyPage.html">EmergencyPage</a></li><li><a href="module-EmergencyProtocols.html">EmergencyProtocols</a></li><li><a href="module-EventsCalendar.html">EventsCalendar</a></li><li><a href="module-Feedback.html">Feedback</a></li><li><a href="module-GlobalVariables%2520-%2520The%2520Global%2520Variables%2520Component.html">GlobalVariables - The Global Variables Component</a></li><li><a href="module-LoginMicrosoft.html">LoginMicrosoft</a></li></ul><h3>Classes</h3><ul><li><a href="Screens.LoginMicrosoft.html">LoginMicrosoft</a></li><li><a href="TwitterFeed.html">TwitterFeed</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AnimatedPressable">AnimatedPressable</a></li><li><a href="global.html#AnimatedTouchable">AnimatedTouchable</a></li><li><a href="global.html#authEmail">authEmail</a></li><li><a href="global.html#authLastName">authLastName</a></li><li><a href="global.html#authName">authName</a></li><li><a href="global.html#authUser">authUser</a></li><li><a href="global.html#authUserProfilePic">authUserProfilePic</a></li><li><a href="global.html#authUserRef">authUserRef</a></li><li><a href="global.html#AVATAR_SIZE">AVATAR_SIZE</a></li><li><a href="global.html#compare">compare</a></li><li><a href="global.html#DATA">DATA</a></li><li><a href="global.html#DATA2">DATA2</a></li><li><a href="global.html#defaultProfilePic">defaultProfilePic</a></li><li><a href="global.html#doctorsList">doctorsList</a></li><li><a href="global.html#eventData">eventData</a></li><li><a href="global.html#EventNotification">EventNotification</a></li><li><a href="global.html#eventsData">eventsData</a></li><li><a href="global.html#generateColor">generateColor</a></li><li><a href="global.html#ICON_SIZE">ICON_SIZE</a></li><li><a href="global.html#initialDate">initialDate</a></li><li><a href="global.html#Item">Item</a></li><li><a href="global.html#ITEM_SIZE">ITEM_SIZE</a></li><li><a href="global.html#MSuser">MSuser</a></li><li><a href="global.html#notificationId">notificationId</a></li><li><a href="global.html#sendData">sendData</a></li><li><a href="global.html#sendToFirestore">sendToFirestore</a></li><li><a href="global.html#showEvent">showEvent</a></li><li><a href="global.html#SPACING">SPACING</a></li><li><a href="global.html#Stack">Stack</a></li><li><a href="global.html#textPos">textPos</a></li><li><a href="global.html#today">today</a></li><li><a href="global.html#validateInput">validateInput</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Fri Oct 28 2022 15:58:33 GMT+0200 (South Africa Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
